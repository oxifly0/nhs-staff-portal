<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Staff Dashboard â€“ Lancashire Teaching Hospitals</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- HEADER -->
  <div class="header">
    <h1>Lancashire Teaching Hospitals NHS Foundation Trust</h1>
  </div>

  <!-- NAVIGATION -->
  <div class="nav">
    <a href="index.html">Home</a>
    <a href="dashboard.html">Dashboard</a>
    <a href="#" onclick="logout()">Log out</a>
  </div>

  <!-- MAIN CONTENT -->
  <div class="main">
    <h2>Staff Dashboard</h2>

    <p id="roleText"></p>

    <!-- MANAGEMENT SECTION -->
   <div id="managementSection">
  <h3>Management Tools</h3>

  <div class="dashboard-actions">
<a class="button" href="staff.html">Add / Edit Staff</a>
  <a class="button" href="#">Assign Roles</a>
</div>
</div>

    <!-- CLINICAL SECTION -->
   <div id="clinicalSection">
  <h3>Clinical Tools</h3>

  <div class="dashboard-actions">
  <a class="button" href="#">View Patients</a><br><br>
  <a class="button" href="#">Update Patient Records</a>
  </div>
</div>
  

<script>
async function loadDashboard() {
  let response;

  try {
    response = await fetch(
      "https://nhs-staff-portal.onrender.com/me",
      {
        credentials: "include"
      }
    );
  } catch {
    window.location.href = "login.html";
    return;
  }

  if (!response.ok) {
    window.location.href = "login.html";
    return;
  }

  const user = await response.json();

  document.getElementById("roleText").innerText =
    "Logged in as: " + user.role;

  if (user.role !== "management") {
    document.getElementById("managementSection").style.display = "none";
  }
}

async function logout() {
  await fetch(
    "https://nhs-staff-portal.onrender.com/logout",
    {
      method: "POST",
      credentials: "include"
    }
  );
  window.location.href = "login.html";
}

loadDashboard();
</script>

</body>
</html>
