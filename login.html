<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Staff Login ‚Äì St Nicholas University Hospitals</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- HEADER -->
  <div class="header">
    <h1>St Nicholas University Hospitals NHS Foundation Trust</h1>
  </div>

  <!-- NAVIGATION -->
  <div class="nav">
    <a href="index.html">Home</a>
    <a href="login.html">Staff Intranet</a>
  </div>

  <!-- LOGIN FORM -->
 <div class="main">
  <h2>Staff Intranet Login</h2>

  <p>Please sign in using your staff credentials.</p>

  <label>Username</label><br>
  <input id="username" type="text" style="width:100%;padding:10px;"><br><br>

  <label>Password</label><br>
  <input id="password" type="password" style="width:100%;padding:10px;"><br><br>

  <button class="button" onclick="login()">Sign in</button>

  <p style="margin-top:20px;">
    Don‚Äôt have an account?
    <a href="register.html">Register here</a>
  </p>

  <p id="error" style="color:rgb(255, 0, 0);"></p>
</div>

  <script>
async function login() {
  const response = await fetch(
    "https://nhs-staff-portal.onrender.com/login",
    {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        username: document.getElementById("username").value,
        password: document.getElementById("password").value
      })
    }
  );

  if (!response.ok) {
    document.getElementById("error").innerText =
      "Invalid username or password";
    return;
  }

  const data = await response.json();

  console.log("LOGIN RESPONSE:", data); // üîç debug

  localStorage.setItem("token", data.token);
  localStorage.setItem("role", data.role);

  window.location.href = "dashboard.html";
}
</script>

</body>
</html>
